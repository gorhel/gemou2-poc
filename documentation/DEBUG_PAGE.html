<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Diagnostic Create-Trade</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1e1e1e;
            color: #00ff00;
        }
        .section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #00ff00;
            border-radius: 5px;
        }
        .error { color: #ff0000; }
        .success { color: #00ff00; }
        .warning { color: #ffaa00; }
        button {
            background: #00ff00;
            color: #1e1e1e;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        button:hover {
            background: #00cc00;
        }
        pre {
            background: #000;
            padding: 10px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>üîç Diagnostic de la page /create-trade</h1>
    
    <div class="section">
        <h2>Instructions</h2>
        <ol>
            <li>Ouvrez la page <code>/create-trade</code> dans un autre onglet</li>
            <li>Ouvrez la console (F12) sur cette page</li>
            <li>Copiez-collez ce code complet dans la console</li>
            <li>Appuyez sur Entr√©e</li>
            <li>Copiez le r√©sultat et partagez-le</li>
        </ol>
    </div>

    <div class="section">
        <h2>üìã Code √† copier-coller dans la console</h2>
        <button onclick="copyCode()">üìã Copier le code</button>
        <pre id="code">
// DIAGNOSTIC COMPLET DE LA PAGE CREATE-TRADE
console.log('üîç ========================================');
console.log('üîç DIAGNOSTIC CREATE-TRADE');
console.log('üîç ========================================');

const diagnostic = {
    timestamp: new Date().toISOString(),
    url: window.location.href,
    
    // 1. Informations de base
    pageInfo: {
        title: document.title,
        bodyLength: document.body.innerHTML.length,
        textContent: document.body.textContent.substring(0, 200).trim(),
    },
    
    // 2. √âl√©ments DOM
    elements: {
        totalDivs: document.querySelectorAll('div').length,
        totalInputs: document.querySelectorAll('input').length,
        totalLabels: document.querySelectorAll('label').length,
        totalButtons: document.querySelectorAll('button').length,
        totalForms: document.querySelectorAll('form').length,
        h1Text: document.querySelector('h1')?.textContent,
        h2Texts: Array.from(document.querySelectorAll('h2')).map(h => h.textContent),
    },
    
    // 3. Composants React (chercher des attributs data-*)
    reactComponents: {
        hasDataReactRoot: !!document.querySelector('[data-reactroot]'),
        hasNextData: !!document.querySelector('#__next'),
        nextContent: document.querySelector('#__next')?.innerHTML?.length || 0,
    },
    
    // 4. Authentification
    auth: {
        hasSupabaseSession: !!localStorage.getItem('supabase.auth.token'),
        hasAnyLocalStorage: Object.keys(localStorage).length,
        localStorageKeys: Object.keys(localStorage),
    },
    
    // 5. Recherche de composants sp√©cifiques
    marketplace: {
        hasImageUpload: !!document.querySelector('[class*="Image"]'),
        hasInputFile: !!document.querySelector('input[type="file"]'),
        hasGameSelect: !!document.querySelector('[class*="Game"]'),
        hasLocationAuto: !!document.querySelector('[class*="Location"]'),
    },
    
    // 6. Texte visible
    visibleText: {
        hasRetour: document.body.textContent.includes('Retour'),
        hasCreer: document.body.textContent.includes('Cr√©er'),
        hasAnnonce: document.body.textContent.includes('annonce'),
        hasVente: document.body.textContent.includes('Vente'),
        hasEchange: document.body.textContent.includes('√âchange'),
        hasChargement: document.body.textContent.includes('Chargement'),
        fullText: document.body.textContent.substring(0, 500),
    },
    
    // 7. Erreurs JavaScript
    errors: {
        hasReactErrors: !!window.__REACT_ERROR__,
        consoleErrors: 'V√©rifiez la console pour les erreurs en rouge',
    }
};

console.log('üìä R√âSULTAT DU DIAGNOSTIC:');
console.log(JSON.stringify(diagnostic, null, 2));

console.log('');
console.log('üéØ ANALYSE RAPIDE:');

// Analyse automatique
if (diagnostic.elements.totalLabels === 0) {
    console.log('‚ùå PROBL√àME: Aucun label trouv√© - Le formulaire ne se charge pas');
}

if (diagnostic.visibleText.hasChargement) {
    console.log('‚ö†Ô∏è  La page est bloqu√©e en √©tat "Chargement..."');
}

if (!diagnostic.auth.hasSupabaseSession) {
    console.log('‚ùå PROBL√àME: Pas de session Supabase - Vous n\'√™tes probablement pas connect√©');
    console.log('   ‚Üí Allez sur /login et connectez-vous');
}

if (diagnostic.reactComponents.nextContent === 0) {
    console.log('‚ùå PROBL√àME: Next.js n\'a pas rendu de contenu');
}

if (diagnostic.elements.totalInputs > 0) {
    console.log('‚úÖ Des inputs sont pr√©sents (' + diagnostic.elements.totalInputs + ')');
}

if (diagnostic.elements.totalLabels > 0) {
    console.log('‚úÖ Des labels sont pr√©sents (' + diagnostic.elements.totalLabels + ')');
}

console.log('');
console.log('üîç ========================================');
console.log('Copiez TOUT ce qui est au-dessus et partagez-le');
console.log('üîç ========================================');

// Retourner le diagnostic pour pouvoir le copier
diagnostic;
        </pre>
    </div>

    <div class="section">
        <h2>‚úÖ Apr√®s avoir ex√©cut√© le code</h2>
        <ol>
            <li>Copiez TOUT le r√©sultat de la console</li>
            <li>Collez-le dans votre r√©ponse</li>
            <li>Cela me permettra de diagnostiquer pr√©cis√©ment le probl√®me</li>
        </ol>
    </div>

    <script>
        function copyCode() {
            const code = document.getElementById('code').textContent;
            navigator.clipboard.writeText(code).then(() => {
                alert('‚úÖ Code copi√© ! Collez-le dans la console de la page /create-trade');
            });
        }
    </script>
</body>
</html>


